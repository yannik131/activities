{% extends 'base.html' %}
{% load i18n %}
{% load static %}
{% load thumbnail %}

{% block title %}{{ activity }}-Lobby{% endblock %}
{% block style %}
{% include "multiplayer/lobby.css" %}
{% endblock %}

{% block content %}
<h1><img src="{% static 'icons/lobby.png' %}"><a href="{{ activity.get_absolute_url }}">{{ activity }}</a>-Lobby</h1>
<p class="info-p">
    {% blocktrans with activity=activity %}Hier können Sie {{ activity }} online spielen. Als Ersteller eines Matches können Sie das Spiel starten, wenn die eingestellte Spieleranzahl anwesend ist. Durch Klick auf den Mülleimer schmeißen Sie Leute raus. Bitte treten Sie dann nicht wieder ohne guten Grund ein! Den Chat erreichen Sie im Spiel über den Chat-Button oben rechts.{% endblocktrans %}
</p>
<div class="button-like" onclick=openLink("{% url 'multiplayer:create_match' activity.name %}")><img src="{% static 'icons/match.png' %}">{% blocktrans %}Match erstellen{% endblocktrans %}</div>
<p></p>
<div class="online-table">
    <table style="float: right;">
        <thead>
            <tr>
                <th>{% trans "Online" %}</th>
            </tr>
        </thead>
        <tbody id="online-list">
            {% for user in online_list %}
                <tr>
                    <td><a href="{{ user.get_absolute_url }}">{{ user }}</a></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div class="joined-matches">
    <h2>{% trans 'Beigetreten' %}</h2>
    <div class="match-list">
        {% for match in user_matches.all %}
            <div class="item">
                <div class="top" style="justify-content: left">
                    <img src="{% static 'icons/match.png' %}" class="image">{{ match.members.count }}/{{ match.member_limit }}
                </div>
                
                <div class="middle">
                    {% for k, v in match.member_positions.items %}{% if v == match.admin.username %}<b style="color: red">{{ v }}</b>{% else %}{{ v }}{% endif %}{% if forloop.counter < match.members.count %}, {% endif %}{% endfor %}
                </div>
                <div class="bottom">
                    <div class="button-like" onclick="openLink('{{ match.get_absolute_url }}')">
                        {% if match.in_progress %}
                            <img src="{% static 'icons/dog.png' %}">
                            {% trans 'Spielen' %}
                        {% else %}
                            <img src="{% static 'icons/chat.png' %}">
                            {% trans 'Zur Übersicht' %}
                        {% endif %}
                    </div>
                </div>
                {% if user == match.admin %}
                <img src="{% static 'icons/admin.png' %}" class="icon">
                {% elif user in match.members.all %}
                <img src="{% static 'icons/member.png' %}" class="icon">
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>
<p style="clear: both"></p>
<div class="other-matches">
    <h2>{% trans 'Öffentliche Liste' %}</h2>
    <div class="match-list" id="other-matches">
        
    </div>
</div>

{% endblock %}
{% block domready %}
    {% include 'javascript/lobby.js' with activity=activity%}
{% endblock %}